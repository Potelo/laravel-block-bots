<?php

return [

    /*
     * Enable / disable firewall
     *
     */

    'enabled' => env('BLOCK_BOTS_ENABLED', true),

    'mode' => env('BLOCK_BOTS_MODE', 'production'),

    'use_default_allowed_bots' => env('BLOCK_BOTS_USE_DEFAULT_ALLOWED_BOTS', true),

    // 'block_when_crash' => env('BLOCK_BOTS_BLOCK_WHEN_CRASH', true),


    'whitelist_key' => env('BLOCK_BOTS_WHITELIST_KEY', "block_bot:whitelist"),

    'fake_bot_list_key' => env('BLOCK_BOTS_FAKE_BOTS_KEY', "block_bot:fake_bots"),

    'pending_bot_list_key' => env('BLOCK_BOTS_PENDING_BOTS_KEY', "block_bot:pending_bots"),


    'ip_info_key' => env('BLOCK_BOTS_IP_INFO_KEY', null),

    /*
     * IPv6 prefix length for rate limiting and tracking.
     * 
     * IPv6 users are typically assigned a prefix from their ISP, giving them
     * millions of unique IP addresses. This setting groups all IPs within 
     * the same prefix for rate limiting purposes.
     *
     * Common values:
     * - 64: Standard /64 allocation (most residential ISPs)
     * - 56: Some ISPs allocate /56 to residential users
     * - 48: Business/enterprise allocations
     *
     * Smaller number = larger prefix = more IPs grouped together
     * Default: 64 (most common residential allocation)
     */
    'ipv6_prefix_length' => env('BLOCK_BOTS_IPV6_PREFIX_LENGTH', 64),

    /*
     * Whitelisted IP addresses.
     * Supports both IPv4 and IPv6 addresses, including CIDR notation.
     * Examples:
     *      '127.0.0.1',
     *      '192.168.0.0/16',
     *      '::1',
     *      '2001:db8::/32',
     */

    'whitelist_ips' => [
        '127.0.0.1',
        '::1'
    ],

    /*
     * Log channel
     */
    'channels_info' => [
        'single'
    ],

    /*
     * This Log channel will receive when a bad crawler is detected or someone is banned
     */
    'channels_blocks' => [
        'single'
    ],

    /*
     * Send suspicious events to log?
     *
     */

    'log' => env('BLOCK_BOTS_LOG_ENABLED', env('BLOCK_BOTS_LOG_BLOCKED_REQUESTS', true)),
    'log_only_guest' => env('BLOCK_BOTS_LOG_ONLY_GUEST', true),

    /*
     * The list of allowed user-agents. The value of the key should be a keyword in hostname or * for enable to everyone
     *
     * For bots that support reverse DNS verification, use the expected hostname.
     * For bots without DNS verification or IP lists, use '*' to allow all IPs with that user-agent.
     */
    'allowed_bots' => [
        'ahrefs' => 'ahrefs',
        'applebot' => 'apple',
        'alexa' => 'alexa',
        'ask' => 'ask',
        'baidu' => 'baidu',
        'bing' => 'msn.com',
        'duckduck' => '*',
        'exabot' => 'exabot',
        'facebook' => 'facebook',
        'google' => 'google',
        'msn' => 'msn',
        'msnbot' => 'msn.com',
        'sogou' => 'sogou',
        'soso' => 'soso',
        'twitter' => 'twitter',
        'yahoo' => 'yahoo',
        'yandex' => 'yandex',
    ],

    /*
     * Allowed bots by IP range.
     *
     * For bots that publish official IP ranges but don't support reverse DNS verification,
     * map the user-agent keyword to an array of CIDR ranges.
     *
     * When a bot matches both 'allowed_bots' and 'allowed_bots_by_ip', the IP range check
     * takes priority. If the IP is in the allowed range, the bot is whitelisted.
     * If not, it falls back to DNS verification (if configured in 'allowed_bots').
     */
    'allowed_bots_by_ip' => [
        // OpenAI GPTBot - https://openai.com/gptbot.json
        'gptbot' => [
            '132.196.86.0/24',
            '172.182.202.0/25',
            '172.182.204.0/24',
            '172.182.207.0/25',
            '172.182.214.0/24',
            '172.182.215.0/24',
            '20.125.66.80/28',
            '20.171.206.0/24',
            '20.171.207.0/24',
            '4.227.36.0/25',
            '52.230.152.0/24',
            '74.7.175.128/25',
            '74.7.227.0/25',
            '74.7.227.128/25',
            '74.7.228.0/25',
            '74.7.230.0/25',
            '74.7.241.0/25',
            '74.7.241.128/25',
            '74.7.242.0/25',
            '74.7.243.128/25',
            '74.7.244.0/25',
        ],

        // OpenAI ChatGPT-User - https://openai.com/chatgpt-user.json
        'chatgpt-user' => [
            '104.210.139.192/28',
            '104.210.139.224/28',
            '13.65.138.112/28',
            '13.65.138.96/28',
            '13.67.46.240/28',
            '13.67.72.16/28',
            '13.70.107.160/28',
            '13.71.2.208/28',
            '13.76.115.224/28',
            '13.76.115.240/28',
            '13.76.116.80/28',
            '13.76.223.48/28',
            '13.76.32.208/28',
            '13.79.43.0/28',
            '13.83.167.128/28',
            '13.83.237.176/28',
            '132.196.82.48/28',
            '135.119.134.128/28',
            '135.119.134.192/28',
            '135.237.131.208/28',
            '135.237.133.112/28',
            '135.237.133.48/28',
            '137.135.183.96/28',
            '137.135.190.240/28',
            '137.135.191.176/28',
            '137.135.191.32/28',
            '138.91.30.48/28',
            '138.91.46.96/28',
            '168.63.252.240/28',
            '172.178.140.144/28',
            '172.178.141.112/28',
            '172.178.141.128/28',
            '172.183.143.224/28',
            '172.183.222.128/28',
            '172.204.16.64/28',
            '172.212.159.64/28',
            '172.213.11.144/28',
            '172.213.12.112/28',
            '172.213.21.112/28',
            '172.213.21.144/28',
            '172.213.21.16/28',
            '191.233.194.32/28',
            '191.233.196.112/28',
            '191.233.199.160/28',
            '191.234.167.128/28',
            '191.235.66.16/28',
            '191.235.98.144/28',
            '191.235.99.80/28',
            '191.237.249.64/28',
            '191.239.245.16/28',
            '20.0.53.96/28',
            '20.102.212.144/28',
            '20.117.22.224/28',
            '20.125.112.224/28',
            '20.125.144.144/28',
            '20.161.75.208/28',
            '20.168.7.192/28',
            '20.168.7.240/28',
            '20.169.72.112/28',
            '20.169.72.96/28',
            '20.169.73.176/28',
            '20.169.73.32/28',
            '20.169.73.64/28',
            '20.169.78.112/28',
            '20.169.78.128/28',
            '20.169.78.144/28',
            '20.169.78.160/28',
            '20.169.78.176/28',
            '20.169.78.192/28',
            '20.169.78.48/28',
            '20.169.78.64/28',
            '20.169.78.80/28',
            '20.169.78.96/28',
            '20.172.29.32/28',
            '20.193.50.32/28',
            '20.194.0.208/28',
            '20.194.1.0/28',
            '20.194.157.176/28',
            '20.198.67.96/28',
            '20.204.24.240/28',
            '20.210.154.128/28',
            '20.210.174.208/28',
            '20.210.211.192/28',
            '20.215.187.208/28',
            '20.215.188.192/28',
            '20.215.214.16/28',
            '20.215.219.128/28',
            '20.215.219.160/28',
            '20.215.219.208/28',
            '20.227.140.32/28',
            '20.228.106.176/28',
            '20.235.75.208/28',
            '20.235.87.224/28',
            '20.249.63.208/28',
            '20.27.94.128/28',
            '20.45.178.144/28',
            '20.55.229.144/28',
            '20.63.221.64/28',
            '20.90.7.144/28',
            '20.97.189.96/28',
            '23.102.140.144/28',
            '23.102.141.32/28',
            '23.97.109.224/28',
            '23.98.142.176/28',
            '23.98.179.16/28',
            '23.98.186.176/28',
            '23.98.186.192/28',
            '23.98.186.64/28',
            '23.98.186.96/28',
            '4.151.119.48/28',
            '4.151.241.240/28',
            '4.151.71.176/28',
            '4.196.118.112/28',
            '4.196.198.80/28',
            '4.197.115.112/28',
            '4.197.19.176/28',
            '4.197.22.112/28',
            '4.197.64.0/28',
            '4.197.64.16/28',
            '4.197.64.48/28',
            '4.197.64.64/28',
            '4.205.128.176/28',
            '40.116.73.208/28',
            '40.75.14.224/28',
            '40.81.234.144/28',
            '40.84.181.32/28',
            '40.84.221.208/28',
            '40.84.221.224/28',
            '51.8.155.112/28',
            '51.8.155.48/28',
            '51.8.155.64/28',
            '51.8.155.80/28',
            '52.148.129.32/28',
            '52.154.22.48/28',
            '52.156.77.144/28',
            '52.159.227.32/28',
            '52.159.249.96/28',
            '52.172.129.160/28',
            '52.173.123.0/28',
            '52.173.219.112/28',
            '52.173.219.96/28',
            '52.173.234.16/28',
            '52.173.234.80/28',
            '52.173.235.80/28',
            '52.176.139.176/28',
            '52.187.246.128/28',
            '52.190.137.144/28',
            '52.190.137.16/28',
            '52.190.139.48/28',
            '52.190.142.64/28',
            '52.190.190.16/28',
            '52.225.75.208/28',
            '52.230.163.32/28',
            '52.230.164.176/28',
            '52.231.30.48/28',
            '52.231.34.176/28',
            '52.231.39.144/28',
            '52.231.39.192/28',
            '52.231.49.48/28',
            '52.231.50.64/28',
            '52.236.94.144/28',
            '52.242.132.224/28',
            '52.242.132.240/28',
            '52.242.245.208/28',
            '52.252.113.240/28',
            '52.255.109.112/28',
            '52.255.109.128/28',
            '52.255.109.144/28',
            '52.255.109.80/28',
            '52.255.109.96/28',
            '52.255.111.0/28',
            '52.255.111.112/28',
            '52.255.111.16/28',
            '52.255.111.32/28',
            '52.255.111.48/28',
            '52.255.111.80/28',
            '57.154.174.112/28',
            '57.154.175.0/28',
            '57.154.187.32/28',
            '68.154.28.96/28',
            '68.218.30.112/28',
            '68.220.57.64/28',
            '68.221.67.160/28',
            '68.221.67.192/28',
            '68.221.67.224/28',
            '68.221.67.240/28',
            '68.221.75.16/28',
            '74.226.253.160/28',
            '74.249.86.176/28',
            '74.7.35.112/28',
            '74.7.35.48/28',
            '74.7.36.64/28',
            '74.7.36.80/28',
            '74.7.36.96/28',
        ],

        // OpenAI OAI-SearchBot - https://openai.com/searchbot.json
        'oai-searchbot' => [
            '104.210.140.128/28',
            '135.234.64.0/24',
            '172.182.193.224/28',
            '172.182.193.80/28',
            '172.182.194.144/28',
            '172.182.194.32/28',
            '172.182.195.48/28',
            '172.182.209.208/28',
            '172.182.211.192/28',
            '172.182.213.192/28',
            '172.182.224.0/28',
            '172.203.190.128/28',
            '20.14.99.96/28',
            '20.168.18.32/28',
            '20.169.6.224/28',
            '20.169.7.48/28',
            '20.169.77.0/25',
            '20.171.123.64/28',
            '20.171.53.224/28',
            '20.25.151.224/28',
            '20.42.10.176/28',
            '4.227.36.0/25',
            '40.67.175.0/25',
            '51.8.102.0/24',
            '74.7.175.128/25',
            '74.7.228.0/25',
            '74.7.228.128/25',
            '74.7.229.0/25',
            '74.7.229.128/25',
            '74.7.230.0/25',
            '74.7.241.128/25',
            '74.7.242.128/25',
            '74.7.243.0/25',
            '74.7.244.0/25',
        ],

        // Anthropic ClaudeBot - https://docs.claude.com/en/api/ip-addresses
        'claudebot' => [
            '160.79.104.0/21',
        ],


        // DuckDuckGo DuckAssistBot - Individual IPs converted to /32
        'duckassistbot' => [
            '57.152.72.128/32',
            '51.8.253.152/32',
            '40.80.242.63/32',
            '20.12.141.99/32',
            '20.49.136.28/32',
            '51.116.131.221/32',
            '51.107.40.209/32',
            '20.40.133.240/32',
            '20.50.168.91/32',
            '51.120.48.122/32',
            '20.193.45.113/32',
            '40.76.173.151/32',
            '40.76.163.7/32',
            '20.185.79.47/32',
            '52.142.26.175/32',
            '20.185.79.15/32',
            '52.142.24.149/32',
            '40.76.162.208/32',
            '40.76.163.23/32',
            '40.76.162.191/32',
            '40.76.162.247/32',
            '40.88.21.235/32',
            '20.191.45.212/32',
            '52.146.59.12/32',
            '52.146.59.156/32',
            '52.146.59.154/32',
            '52.146.58.236/32',
            '20.62.224.44/32',
            '51.104.180.53/32',
            '51.104.180.47/32',
            '51.104.180.26/32',
            '51.104.146.225/32',
            '51.104.146.235/32',
            '20.73.202.147/32',
            '20.73.132.240/32',
            '20.71.12.143/32',
            '20.56.197.58/32',
            '20.56.197.63/32',
            '20.43.150.93/32',
            '20.43.150.85/32',
            '20.44.222.1/32',
            '40.89.243.175/32',
            '13.89.106.77/32',
            '52.143.242.6/32',
            '52.143.241.111/32',
            '52.154.60.82/32',
            '20.197.209.11/32',
            '20.197.209.27/32',
            '20.226.133.105/32',
            '191.234.216.4/32',
            '191.234.216.178/32',
            '20.53.92.211/32',
            '20.53.91.2/32',
            '20.207.99.197/32',
            '20.207.97.190/32',
            '40.81.250.205/32',
            '40.64.106.11/32',
            '40.64.105.247/32',
            '20.72.242.93/32',
            '20.99.255.235/32',
            '20.113.3.121/32',
            '52.224.16.221/32',
            '52.224.21.53/32',
            '52.224.20.204/32',
            '52.224.21.19/32',
            '52.224.20.249/32',
            '52.224.20.203/32',
            '52.224.20.190/32',
            '52.224.16.229/32',
            '52.224.21.20/32',
            '52.146.63.80/32',
            '52.224.20.227/32',
            '52.224.20.193/32',
            '52.190.37.160/32',
            '52.224.21.23/32',
            '52.224.20.223/32',
            '52.224.20.181/32',
            '52.224.21.49/32',
            '52.224.21.55/32',
            '52.224.21.61/32',
            '52.224.19.152/32',
            '52.224.20.186/32',
            '52.224.21.27/32',
            '52.224.21.51/32',
            '52.224.20.174/32',
            '52.224.21.4/32',
            '51.104.164.109/32',
            '51.104.167.71/32',
            '51.104.160.177/32',
            '51.104.162.149/32',
            '51.104.167.95/32',
            '51.104.167.54/32',
            '51.104.166.111/32',
            '51.104.167.88/32',
            '51.104.161.32/32',
            '51.104.163.250/32',
            '51.104.164.189/32',
            '51.104.167.19/32',
            '51.104.160.167/32',
            '51.104.167.110/32',
            '20.191.44.119/32',
            '51.104.167.104/32',
            '20.191.44.234/32',
            '51.104.164.215/32',
            '51.104.167.52/32',
            '20.191.44.22/32',
            '51.104.167.87/32',
            '51.104.167.96/32',
            '20.191.44.16/32',
            '51.104.167.61/32',
            '51.104.164.147/32',
            '20.50.48.159/32',
            '40.114.182.172/32',
            '20.50.50.130/32',
            '20.50.50.163/32',
            '20.50.50.46/32',
            '40.114.182.153/32',
            '20.50.50.118/32',
            '20.50.49.55/32',
            '20.50.49.25/32',
            '40.114.183.251/32',
            '20.50.50.123/32',
            '20.50.49.237/32',
            '20.50.48.192/32',
            '20.50.50.134/32',
            '51.138.90.233/32',
            '40.114.183.196/32',
            '20.50.50.146/32',
            '40.114.183.88/32',
            '20.50.50.145/32',
            '20.50.50.121/32',
            '20.50.49.40/32',
            '51.138.90.206/32',
            '40.114.182.45/32',
            '51.138.90.161/32',
            '20.50.49.0/32',
            '40.119.232.215/32',
            '104.43.55.167/32',
            '40.119.232.251/32',
            '40.119.232.50/32',
            '40.119.232.146/32',
            '40.119.232.218/32',
            '104.43.54.127/32',
            '104.43.55.117/32',
            '104.43.55.116/32',
            '104.43.55.166/32',
            '52.154.169.50/32',
            '52.154.171.70/32',
            '52.154.170.229/32',
            '52.154.170.113/32',
            '52.154.171.44/32',
            '52.154.172.2/32',
            '52.143.244.81/32',
            '52.154.171.87/32',
            '52.154.171.250/32',
            '52.154.170.28/32',
            '52.154.170.122/32',
            '52.143.243.117/32',
            '52.143.247.235/32',
            '52.154.171.235/32',
            '52.154.171.196/32',
            '52.154.171.0/32',
            '52.154.170.243/32',
            '52.154.170.26/32',
            '52.154.169.200/32',
            '52.154.170.96/32',
            '52.154.170.88/32',
            '52.154.171.150/32',
            '52.154.171.205/32',
            '52.154.170.117/32',
            '52.154.170.209/32',
            '191.235.202.48/32',
            '191.233.3.202/32',
            '191.235.201.214/32',
            '191.233.3.197/32',
            '191.235.202.38/32',
            '20.53.78.144/32',
            '20.193.24.10/32',
            '20.53.78.236/32',
            '20.53.78.138/32',
            '20.53.78.123/32',
            '20.53.78.106/32',
            '20.193.27.215/32',
            '20.193.25.197/32',
            '20.193.12.126/32',
            '20.193.24.251/32',
            '20.204.242.101/32',
            '20.207.72.113/32',
            '20.204.242.19/32',
            '20.219.45.67/32',
            '20.207.72.11/32',
            '20.219.45.190/32',
            '20.204.243.55/32',
            '20.204.241.148/32',
            '20.207.72.110/32',
            '20.204.240.172/32',
            '20.207.72.21/32',
            '20.204.246.81/32',
            '20.207.107.181/32',
            '20.204.246.254/32',
            '20.219.43.246/32',
            '52.149.25.43/32',
            '52.149.61.51/32',
            '52.149.58.139/32',
            '52.149.60.38/32',
            '52.148.165.38/32',
            '52.143.95.162/32',
            '52.149.56.151/32',
            '52.149.30.45/32',
            '52.149.58.173/32',
            '52.143.95.204/32',
            '52.149.28.83/32',
            '52.149.58.69/32',
            '52.148.161.87/32',
            '52.149.58.27/32',
            '52.149.28.18/32',
            '20.79.226.26/32',
            '20.79.239.66/32',
            '20.79.238.198/32',
            '20.113.14.159/32',
            '20.75.144.152/32',
            '20.43.172.120/32',
            '20.53.134.160/32',
            '20.201.15.208/32',
            '20.93.28.24/32',
            '20.61.34.40/32',
            '52.242.224.168/32',
            '20.80.129.80/32',
            '20.195.108.47/32',
            '4.195.133.120/32',
            '4.228.76.163/32',
            '4.182.131.108/32',
            '4.209.224.56/32',
            '108.141.83.74/32',
            '4.213.46.14/32',
            '172.169.17.165/32',
            '51.8.71.117/32',
            '20.3.1.178/32',
        ],

    ],

    /*
     * Default json response when blocked
     */
    'json_response' => [
        'message' => 'Você está acima do limite.'
    ],

    /*
     * Default timezone for store Redis TTL
     */
    'timezone' => 'UTC',
];
